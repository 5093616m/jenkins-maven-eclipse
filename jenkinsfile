pipeline{
	agent any
	tools {
		maven "maven3.9.6"
		jdk "OpenJDK11"
	}
	environment {
    PATH = "C:\\WINDOWS\\SYSTEM32"
	}
	stages {
		stage("clean"){
			steps{
			echo "Start Clean"
			bat "mvn clean"
			}
		}
		stage("test"){
			steps{
			echo "Start Test"
			bat "mvn test"
			}
		}
		stage("build"){
			steps{
			echo "Start build"
			bat "mvn install -DskipTests"
			}
		}
		stage('SonarQube analysis') {
		    withSonarQubeEnv(credentialsId: 'squ_631cdc312467ff05afd2ceec38d41b8d57f1c691', installationName: 'sonarqube') {
		    bat 'mvn org.sonarsource.scanner.maven:sonar-maven-plugin:5.6:sonar'
	    	}
	    }
    }
}